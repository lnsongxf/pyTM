
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Introduction to Z-Transforms &mdash; pyTM 1.0 documentation</title>
    
    <link rel="stylesheet" href="../_static/traditional.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="pyTM 1.0 documentation" href="../index.html" />
    <link rel="next" title="The Z-Transform" href="definition.html" />
    <link rel="prev" title="Simple linear prediction theory" href="../linear_pred/lin_pred.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="definition.html" title="The Z-Transform"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../linear_pred/lin_pred.html" title="Simple linear prediction theory"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">pyTM 1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="introduction-to-z-transforms">
<h1><a class="toc-backref" href="#id11">Introduction to Z-Transforms</a><a class="headerlink" href="#introduction-to-z-transforms" title="Permalink to this headline">¶</a></h1>
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#introduction-to-z-transforms" id="id11">Introduction to Z-Transforms</a><ul>
<li><a class="reference internal" href="#the-z-transform" id="id12">The Z-Transform</a><ul>
<li><a class="reference internal" href="#first-example" id="id13">First Example</a></li>
<li><a class="reference internal" href="#second-example" id="id14">Second Example</a></li>
<li><a class="reference internal" href="#on-your-own" id="id15">On Your Own</a></li>
</ul>
</li>
<li><a class="reference internal" href="#transform-table" id="id16">Transform Table</a></li>
<li><a class="reference internal" href="#the-inverse-z-transform" id="id17">The Inverse Z-Transform</a><ul>
<li><a class="reference internal" href="#example" id="id18">Example</a></li>
</ul>
</li>
<li><a class="reference internal" href="#properties-of-the-z-transform" id="id19">Properties of the Z-Transform</a></li>
<li><a class="reference internal" href="#theorems-associated-with-the-z-transform" id="id20">Theorems Associated with the Z-Transform</a></li>
<li><a class="reference internal" href="#solving-a-linear-difference-equation" id="id21">Solving a Linear Difference Equation</a></li>
<li><a class="reference internal" href="#present-value-calculations" id="id22">Present Value Calculations</a><ul>
<li><a class="reference internal" href="#first-pv-example" id="id23">First PV Example</a></li>
<li><a class="reference internal" href="#second-pv-example" id="id24">Second PV Example</a></li>
<li><a class="reference internal" href="#reminders-for-pv-calculations" id="id25">Reminders for PV Calculations</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="toctree-wrapper compound">
</div>
<p>This lecture describes the z-transform.  If you don&#8217;t know about Laplace transforms, please ignore the following <a href="#id1"><span class="problematic" id="id2">`</span></a>helpful&#8217; remarks.
The z-transform is a discrete time version of the Laplace transform.  It shares many properties of the Laplace transform.  If you don&#8217;t know the
Laplace transform, do not fear this lecture. It is self-contained.</p>
<div class="section" id="the-z-transform">
<h2><a class="toc-backref" href="#id12">The Z-Transform</a><a class="headerlink" href="#the-z-transform" title="Permalink to this headline">¶</a></h2>
<p>A <em>one-sided sequence</em> is a sequence <span class="math">\(\{x(k)\}, k= 0, 1, \ldots\)</span></p>
<p>The subscript <span class="math">\(k\)</span> often denotes time</p>
<p>The one-sided z-transform maps a <em>one-sided sequence</em> into a function of complex variable <span class="math">\(z\)</span></p>
<p>z-Transform (one sided)</p>
<blockquote>
<div><p>The z-transform of a sampled sequence  <span class="math">\(x(k)\)</span>, where <span class="math">\(k\)</span> represents non-negative integers is defined by the following equation.</p>
<div class="math" id="equation-eq_ZTdef">
<span class="eqno">(1)</span>\[X(z) \equiv \mathcal{Z}[x(k)] \equiv \sum_{k=0}^\infty x(k) z^{-k}\]</div>
</div></blockquote>
<p>The complex variable <span class="math">\(z\)</span> must take a value that makes  the sum converge <a class="footnote-reference" href="#fdef1" id="id3">[1]</a> :</p>
<p>Before we discuss some of its uses, let&#8217;s practice calculating some z-transforms</p>
<div class="section" id="first-example">
<h3><a class="toc-backref" href="#id13">First Example</a><a class="headerlink" href="#first-example" title="Permalink to this headline">¶</a></h3>
<p>Consider the unit step function</p>
<div class="math">
\[\begin{split}u(k) = \begin{cases} 1 &amp; \text{if } k&gt;0 \\ 0 &amp; \text{else} \end{cases}\end{split}\]</div>
<p>Using the definition.</p>
<div class="math">
\[\begin{split}X(z) = \mathcal{Z}[u(k)] &amp;= \sum_{k=0}^\infty 1 z^{-k} \\
&amp;= 1 + z^{-1} + z^{-2} + \dots \\
&amp;= \frac{1}{1 - z^{-1}} \\
&amp;= \frac{z}{z-1}\end{split}\]</div>
<p>This z-transform is well defined on the domain <span class="math">\(|z|&gt;1\)</span>.</p>
</div>
<div class="section" id="second-example">
<h3><a class="toc-backref" href="#id14">Second Example</a><a class="headerlink" href="#second-example" title="Permalink to this headline">¶</a></h3>
<p>Consider the sequence</p>
<div class="math">
\[\begin{split}x(k) = \begin{cases} a^k &amp; \text{if } k \geq 0 \\ 0 &amp; \text{if } k &lt; 0 \end{cases}\end{split}\]</div>
<p>Use the definition again</p>
<div class="math">
\[\begin{split}X(z) = \mathcal{Z}[x(k)] &amp;= \sum_{k=0}^\infty a^k z^{-k} \\
&amp;= \sum_{k=0}^\infty (a^{-1} z)^{-k}\\
&amp;= \frac{1}{1 - (a^{-1}z)^{-1}} \\
&amp;= \frac{z}{z-a}\end{split}\]</div>
<p>This z-transform is well defined on the domain <span class="math">\(|z|&gt;a\)</span>.</p>
</div>
<div class="section" id="on-your-own">
<h3><a class="toc-backref" href="#id15">On Your Own</a><a class="headerlink" href="#on-your-own" title="Permalink to this headline">¶</a></h3>
<p>Now try to calculate the z-transform of the sequence:</p>
<div class="math">
\[\begin{split}x(k) = \begin{cases} \sin( \omega k T) &amp; \text{if } k \geq 0 \\ 0 &amp; \text{if } k &lt; 0 \end{cases}\end{split}\]</div>
<p>For what domain of <span class="math">\(z\)</span> values is it defined?</p>
<div class="admonition hint">
<p class="first admonition-title">Hint</p>
<p class="last">Try writing it in terms of the definition of sin.  <span class="math">\(\sin(x) = \frac{e^{ix} - e^{-ix}}{2i}\)</span>.</p>
</div>
<table class="docutils footnote" frame="void" id="fdef1" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id3">[1]</a></td><td>Some people define the transform as <span class="math">\(\sum_{k=0}^\infty x(k) z^{k}\)</span>.  We will use our definition, but if you want to use the other one, all of this material can be easily translated by converting all of the <span class="math">\(z\)</span>&#8216;s to <span class="math">\(\frac{1}{z}\)</span>&#8216;s.</td></tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="transform-table">
<h2><a class="toc-backref" href="#id16">Transform Table</a><a class="headerlink" href="#transform-table" title="Permalink to this headline">¶</a></h2>
<p>This table gives z-transforms of particular functions. In table <a class="footnote-reference" href="#ftable1" id="id4">[2]</a> we use the following definitions:</p>
<div class="math">
\[\begin{split}u[n] = \begin{cases} 1, &amp; n \ge 0 \\ 0, &amp; n &lt; 0 \end{cases}\end{split}\]\[\begin{split}\delta[n] = \begin{cases} 1, &amp; n = 0 \\ 0, &amp; n \ne 0 \end{cases}\end{split}\]</div>
<table border="1" class="docutils" id="id5">
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sequence, <span class="math">\(x[n]\)</span></th>
<th class="head">Z-transform, <span class="math">\(X(z)\)</span></th>
<th class="head">radius of convergence</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><span class="math">\(\delta[n]\)</span></td>
<td>1</td>
<td>all &#8220;z&#8221;</td>
</tr>
<tr class="row-odd"><td><span class="math">\(\delta[n-n_0]\)</span></td>
<td><span class="math">\(z^{-n_0}\)</span></td>
<td><span class="math">\(z \neq 0\)</span></td>
</tr>
<tr class="row-even"><td><span class="math">\(u[n]\)</span></td>
<td><span class="math">\(\frac{1}{1-z^{-1} }\)</span></td>
<td><span class="math">\(|z| &gt; 1\)</span></td>
</tr>
<tr class="row-odd"><td><span class="math">\(e^{-\alpha n} u[n]\)</span></td>
<td><span class="math">\(1 \over 1-e^{-\alpha  }z^{-1}\)</span></td>
<td><span class="math">\(|z| &gt;  |e^{-\alpha}| \,\)</span></td>
</tr>
<tr class="row-even"><td><span class="math">\(-u[-n-1]\)</span></td>
<td><span class="math">\(\frac{1}{1 - z^{-1}}\)</span></td>
<td><span class="math">\(|z| &lt; 1\)</span></td>
</tr>
<tr class="row-odd"><td><span class="math">\(n u[n]\)</span></td>
<td><span class="math">\(\frac{z^{-1}}{( 1-z^{-1} )^2}\)</span></td>
<td><span class="math">\(|z| &gt; 1\)</span></td>
</tr>
<tr class="row-even"><td><span class="math">\(- n u[-n-1] \,\)</span></td>
<td><span class="math">\(\frac{z^{-1} }{ (1 - z^{-1})^2 }\)</span></td>
<td><span class="math">\(|z| &lt; 1\)</span></td>
</tr>
<tr class="row-odd"><td><span class="math">\(n^2 u[n]\)</span></td>
<td><span class="math">\(\frac{ z^{-1} (1 + z^{-1} )}{(1 - z^{-1})^3}\)</span></td>
<td><span class="math">\(|z| &gt; 1\,\)</span></td>
</tr>
<tr class="row-even"><td><span class="math">\(- n^2 u[-n - 1] \,\)</span></td>
<td><span class="math">\(\frac{ z^{-1} (1 + z^{-1} )}{(1 - z^{-1})^3}\)</span></td>
<td><span class="math">\(|z| &lt; 1\,\)</span></td>
</tr>
<tr class="row-odd"><td><span class="math">\(n^3 u[n]\)</span></td>
<td><span class="math">\(\frac{z^{-1} (1 + 4 z^{-1} + z^{-2} )}{(1-z^{-1})^4}\)</span></td>
<td><span class="math">\(|z| &gt; 1\,\)</span></td>
</tr>
<tr class="row-even"><td><span class="math">\(- n^3 u[-n -1]\)</span></td>
<td><span class="math">\(\frac{z^{-1} (1 + 4 z^{-1} + z^{-2} )}{(1-z^{-1})^4}\)</span></td>
<td><span class="math">\(|z| &lt; 1\,\)</span></td>
</tr>
<tr class="row-odd"><td><span class="math">\(a^n u[n]\)</span></td>
<td><span class="math">\(\frac{1}{1-a z^{-1}}\)</span></td>
<td><span class="math">\(|z| &gt; |a|\)</span></td>
</tr>
<tr class="row-even"><td><span class="math">\(-a^n u[-n-1]\)</span></td>
<td><span class="math">\(\frac{1}{1-a z^{-1}}\)</span></td>
<td><span class="math">\(|z| &lt; |a|\)</span></td>
</tr>
<tr class="row-odd"><td><span class="math">\(n a^n u[n]\)</span></td>
<td><span class="math">\(\frac{az^{-1} }{ (1-a z^{-1})^2 }\)</span></td>
<td><span class="math">\(|z| &gt; |a|\)</span></td>
</tr>
<tr class="row-even"><td><span class="math">\(-n a^n u[-n-1]\)</span></td>
<td><span class="math">\(\frac{az^{-1} }{ (1-a z^{-1})^2 }\)</span></td>
<td><span class="math">\(|z| &lt; |a|\)</span></td>
</tr>
<tr class="row-odd"><td><span class="math">\(n^2 a^n u[n]\)</span></td>
<td><span class="math">\(\frac{a z^{-1} (1 + a z^{-1}) }{(1-a z^{-1})^3}\)</span></td>
<td><span class="math">\(|z| &gt; |a|\)</span></td>
</tr>
<tr class="row-even"><td><span class="math">\(- n^2 a^n u[-n -1]\)</span></td>
<td><span class="math">\(\frac{a z^{-1} (1 + a z^{-1}) }{(1-a z^{-1})^3}\)</span></td>
<td><span class="math">\(|z| &lt; |a|\)</span></td>
</tr>
<tr class="row-odd"><td><span class="math">\(\cos(\omega_0 n) u[n]\)</span></td>
<td><span class="math">\(\frac{ 1-z^{-1} \cos(\omega_0)}{ 1-2z^{-1}\cos(\omega_0)+ z^{-2}}\)</span></td>
<td><span class="math">\(|z| &gt;1\)</span></td>
</tr>
<tr class="row-even"><td><span class="math">\(\sin(\omega_0 n) u[n]\)</span></td>
<td><span class="math">\(\frac{ z^{-1} \sin(\omega_0)}{ 1-2z^{-1}\cos(\omega_0)+ z^{-2} }\)</span></td>
<td><span class="math">\(|z| &gt;1\)</span></td>
</tr>
<tr class="row-odd"><td><span class="math">\(a^n \cos(\omega_0 n) u[n]\)</span></td>
<td><span class="math">\(\frac{1-a z^{-1} \cos( \omega_0)}{1-2az^{-1}\cos(\omega_0)+ a^2 z^{-2}}\)</span></td>
<td><span class="math">\(|z|&gt;|a|\)</span></td>
</tr>
<tr class="row-even"><td><span class="math">\(a^n \sin(\omega_0 n) u[n]\)</span></td>
<td><span class="math">\(\frac{ az^{-1} \sin(\omega_0) }{ 1-2az^{-1}\cos(\omega_0)+ a^2 z^{-2} }\)</span></td>
<td><span class="math">\(|z|&gt;|a|\)</span></td>
</tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="ftable1" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id4">[2]</a></td><td>This  is a modified version of a table on the <a class="reference external" href="http://en.wikipedia.org/wiki/Z-transform">Wikipedia Page</a>.</td></tr>
</tbody>
</table>
</div>
<div class="section" id="the-inverse-z-transform">
<h2><a class="toc-backref" href="#id17">The Inverse Z-Transform</a><a class="headerlink" href="#the-inverse-z-transform" title="Permalink to this headline">¶</a></h2>
<p>Given a function <span class="math">\(X(z)\)</span>, we might want to find a sequence <span class="math">\(x(k)\)</span> of which it is the z-transform.  This is where the inverse z-transform comes in</p>
<dl class="docutils">
<dt><strong>Inverse z-transform</strong></dt>
<dd>The inverse z-transform is defined as:</dd>
</dl>
<div class="math">
\[x(k) = \mathcal{Z}^{-1}[X(z)] = \frac{1}{2 \pi i} \oint_C X(z) z^{k-1} \partial z\]</div>
<p>The contour integral can be evaluated using the  Cauchy Residue Theorem, a result from complex analysis.</p>
<p>The contour of integration  should enclose all singularities of <span class="math">\(X(z)\)</span>.</p>
<p>Fortunately, there are easier ways to calculate the inverse z-transform.</p>
<p>One useful technique is to the (complex) function into a sum of functions in the table, then apply the corresponding inverse z-transforms to each component</p>
<p>Steps:</p>
<ol class="arabic simple">
<li>Break up the function through a partial fraction expansion of <span class="math">\(G[z] = \frac{F[z]}{z}\)</span>. This helps us get needed constant terms.</li>
<li>Multiply by <span class="math">\(z\)</span> to get back to <span class="math">\(F[z]\)</span>.</li>
<li>Put each piece into a recognizable form.</li>
<li>Transform each piece.</li>
</ol>
<p>Here is an example of how this works</p>
<div class="section" id="example">
<h3><a class="toc-backref" href="#id18">Example</a><a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h3>
<p>Find the inverse z-transform of the function <span class="math">\(X[z] = \frac{8z - 19}{(z-2)(z-3)z}\)</span>.</p>
<p>Apply the steps:</p>
<ol class="arabic simple">
<li>Use partial fraction expansion to get <span class="math">\(G[z] = \frac{X[z]}{z} = \frac{c_1}{(z-2)} + \frac{c_2}{(z-3)} + \frac{c_3}{z}\)</span>.</li>
<li>Calculate the constants <span class="math">\(c_1, c_2, c_3\)</span> and get <span class="math">\(G[z] = \frac{(-19/6)}{z} + \frac{(3/2)}{(z-2)} + \frac{(5/3)}{(z-3)}\)</span>.</li>
<li>Multiply by <span class="math">\(z\)</span> to get <span class="math">\(X[z] = \frac{-19}{6} + \frac{(3/2)z}{(z-2)} + \frac{(5/3)z}{(z-3)}\)</span>.</li>
<li>Read each piece off of the table to get the inverse z-transform of each piece to get <span class="math">\(x[k]\)</span></li>
</ol>
<div class="math">
\[\frac{-19}{6} \rightarrow \frac{-19}{6} \delta[k]\]\[\frac{(3/2)z}{(z-2)} \rightarrow \frac{3}{2} (2)^k u[k]\]\[\frac{(5/3)z}{(z-3)} \rightarrow \frac{5}{3} (3)^k u[k]\]</div>
<p>This gives  <span class="math">\(x[k] = \frac{-19}{6} \delta[k] + \left(\frac{3}{2} (2)^k + \frac{5}{3} (3)^k \right) u[k]\)</span></p>
</div>
</div>
<div class="section" id="properties-of-the-z-transform">
<h2><a class="toc-backref" href="#id19">Properties of the Z-Transform</a><a class="headerlink" href="#properties-of-the-z-transform" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div>The Z-transform has many useful properties. We list some here. <a class="footnote-reference" href="#fprop1" id="id6">[3]</a></div></blockquote>
<table border="1" class="docutils" id="z-transform-properties">
<colgroup>
<col width="25%" />
<col width="38%" />
<col width="38%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head stub">Property</th>
<th class="head">n - domain( <span class="math">\(x[n]\)</span> )</th>
<th class="head">Z - domain ( <span class="math">\(X(z)\)</span> )</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><th class="stub">Linearity</th>
<td><span class="math">\(a_1 x_1[n] + z_2 x_2[n]\)</span></td>
<td><span class="math">\(a_1 X_1(z) + a_2 X_2(z)\)</span></td>
</tr>
<tr class="row-odd"><th class="stub">Time Expansion</th>
<td><span class="math">\(x_{(k)}[n] = \begin{cases} x[r],  n=rk \\ 0,  n \ne rk\end{cases}\)</span></td>
<td><span class="math">\(X(z^k)\)</span></td>
</tr>
<tr class="row-even"><th class="stub">Time Shifting (backwards) <a class="footnote-reference" href="#fprop2" id="id7">[4]</a></th>
<td><span class="math">\(x[n-k]\)</span></td>
<td><span class="math">\(z^{-k}X(z)\)</span></td>
</tr>
<tr class="row-odd"><th class="stub">Time Shifting (forwards)</th>
<td><span class="math">\(x[n+k]\)</span></td>
<td><span class="math">\(z^{k}X(z) - z^{k}x(0) - z^{k-1}x(1) - ... - z x(d-1)\)</span></td>
</tr>
<tr class="row-even"><th class="stub">Scaling in z-domain</th>
<td><span class="math">\(a^n x[n]\)</span></td>
<td><span class="math">\(X(a^{-1}z)\)</span></td>
</tr>
<tr class="row-odd"><th class="stub">Time Reversal</th>
<td><span class="math">\(x[-n]\)</span></td>
<td><span class="math">\(X(z^{-1})\)</span></td>
</tr>
<tr class="row-even"><th class="stub">Complex Conjugation</th>
<td><span class="math">\(x^*[n]\)</span></td>
<td><span class="math">\(X^*(z^*)\)</span></td>
</tr>
<tr class="row-odd"><th class="stub">Differentiation</th>
<td><span class="math">\(n x[n]\)</span></td>
<td><span class="math">\(-z \frac{\partial X(z)}{\partial z}\)</span></td>
</tr>
<tr class="row-even"><th class="stub">Convolution</th>
<td><span class="math">\(x_1[n] \ast x_2[n]\)</span></td>
<td><span class="math">\(X_1(z) X_2(z)\)</span></td>
</tr>
<tr class="row-odd"><th class="stub">Cross-Correlation</th>
<td><span class="math">\(r_{x_1, x_2} = x_1^*[-n] \ast x_2[n]\)</span></td>
<td><span class="math">\(R_{x_1, x_2}(z) = X_1^*(\frac{1}{z^*}) X_2(z)\)</span></td>
</tr>
<tr class="row-even"><th class="stub">Multiplication</th>
<td><span class="math">\(x_1[n]x_2[n]\)</span></td>
<td><span class="math">\(\frac{1}{i 2 \pi} \oint X_1(v) X_2(\frac{z}{v})v^{-1} dv\)</span></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="theorems-associated-with-the-z-transform">
<h2><a class="toc-backref" href="#id20">Theorems Associated with the Z-Transform</a><a class="headerlink" href="#theorems-associated-with-the-z-transform" title="Permalink to this headline">¶</a></h2>
<table border="1" class="docutils" id="z-transform-theorems">
<colgroup>
<col width="30%" />
<col width="70%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head stub">Theorem</th>
<th class="head">Mathematical Representation</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><th class="stub">Parseval&#8217;s Theorem</th>
<td><span class="math">\(\sum_{b=-\infty}^{\infty} x_1[n]x_2^*[n] = \frac{1}{i 2 \pi} \oint X_1(v) X_2^*(\frac{1}{v})v^{-1} dv\)</span></td>
</tr>
<tr class="row-odd"><th class="stub">Initial Value Thm</th>
<td><span class="math">\(x[0] = \lim_{z \rightarrow \infty} X(z)\)</span></td>
</tr>
<tr class="row-even"><th class="stub">Final Value Thm</th>
<td><span class="math">\(x[\infty] = \lim_{z \rightarrow 1} (z-1) X(z)\)</span></td>
</tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="fprop1" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id6">[3]</a></td><td>Many of these properties are  on this <a class="reference external" href="http://en.wikipedia.org/wiki/Z-transform">Wikipedia Page</a>. There you can find proofs for most of them.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="fprop2" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id7">[4]</a></td><td>This property is very important in many economic contexts, as we shall see soon.</td></tr>
</tbody>
</table>
</div>
<div class="section" id="solving-a-linear-difference-equation">
<h2><a class="toc-backref" href="#id21">Solving a Linear Difference Equation</a><a class="headerlink" href="#solving-a-linear-difference-equation" title="Permalink to this headline">¶</a></h2>
<p>As an example of a difference equation, we study a backward rectangle approximation of an integral.  Let <span class="math">\(x(k)\)</span> be the value of the integral at point <span class="math">\(k\)</span> and similarly <span class="math">\(x(k-1)\)</span> is the value at point <span class="math">\(k-1\)</span> etc...  Let the value of the function at point <span class="math">\(k\)</span> be given as <span class="math">\(y(k)\)</span>.  Then the value of the backward rectangle approximation at point <span class="math">\(k\)</span> can be expressed as:</p>
<div class="math">
\[x(k) = x(k-1) + T y(k-1)\]</div>
<a class="reference internal image-reference" href="../_images/backwardrect.png"><img alt="../_images/backwardrect.png" src="../_images/backwardrect.png" style="width: 600.0px; height: 450.0px;" /></a>
<p>Although this problem could be solved via backward substitution and basic algebra <a class="footnote-reference" href="#fdiff1" id="id9">[5]</a>, this approach will not solve all linear difference equations.  Instead, we will examine how to use z-transforms to solve linear difference equations.  This method makes extensive use of the time-shift properties mentioned above.</p>
<p>The first step to solving a simple linear difference equation, <span class="math">\(x(k) = f(x(k-1), x(k-2), \dots, u(k), u(k-1), \dots)\)</span>, with z-transforms is to take the z-transform.  Then you should combine elements (time-shift properties allow everything to be expressed only in terms of <span class="math">\(X(z)\)</span>) and leave the equation in the form <span class="math">\(X(z)=f(z)\)</span> where <span class="math">\(f(z)\)</span> is some function.  We can then take the inverse z-transform of <span class="math">\(X(z) = f(z)\)</span> to get a functional form of <span class="math">\(x(k)\)</span> in terms of only <span class="math">\(k\)</span>.</p>
<p>Let&#8217;s now return to solving the example backward rectangle approximation from before.  Let the equation we are taking the integral of be <span class="math">\(y(k) = k^2 + 1\)</span> from 0 to 2 in 1 unit steps (Thus <span class="math">\(T=1\)</span>).</p>
<div class="math">
\[\begin{split}x(k) &amp;= x(k-1) + y(k-1) \\
x(k) - x(k-1) &amp;= y(k-1) \\
X(z) - z^{-1} X(z) &amp;= z^{-1} Y(k)\\
X(z) &amp;= \frac{z^{-1}}{1 - z^{-1}} Y(z) \\
x(k) &amp;= u[n] y(k)\end{split}\]</div>
<p>Now, since we already know what <span class="math">\(n\)</span> and <span class="math">\(y(k)\)</span> are <a class="footnote-reference" href="#fdiff2" id="id10">[6]</a>, we can simply plug in the values we need.</p>
<div class="math">
\[x(k) = u[0] (k^2 + 1)\]</div>
<p>This is the solution to the linear difference equation.</p>
<table class="docutils footnote" frame="void" id="fdiff1" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id9">[5]</a></td><td>Doing this obtains the equation <span class="math">\(x(k) = x(0) + T \sum_{j=0}^{k-1} y(j)\)</span>.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="fdiff2" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id10">[6]</a></td><td>Since we are integrating from 0 to 2 then <span class="math">\(n=0\)</span> and we are given a function <span class="math">\(y(k) = k^2 + 1\)</span></td></tr>
</tbody>
</table>
</div>
<div class="section" id="present-value-calculations">
<h2><a class="toc-backref" href="#id22">Present Value Calculations</a><a class="headerlink" href="#present-value-calculations" title="Permalink to this headline">¶</a></h2>
<p>One natural application of Z-transforms is to compute the present value (PV) of an income stream when a discount factor is constant. Let this stream be represented by a sequence of real numbers <span class="math">\(\{x_n\}_{n=0}^{\infty}\)</span> and let <span class="math">\(\beta \in (0, 1)\)</span> be a constant discount factor. The present value of this sequence is defined as</p>
<div class="math" id="equation-eq_PVdef">
<span class="eqno">(2)</span>\[PV(\beta) = \sum_{n=0}^{\infty} \beta^n x_n\]</div>
<p>Notice how Equation <a href="#equation-eq_PVdef">(2)</a> looks very much like the definition of the z-transform <a href="#equation-eq_ZTdef">(1)</a> of <span class="math">\(x_n\)</span> in terms of <span class="math">\(\beta\)</span>, instead of <span class="math">\(z\)</span>. The only difference is that the exponent on <span class="math">\(\beta\)</span> here is <span class="math">\(+n\)</span> instead of the <span class="math">\(-n\)</span> from the definition. These two representations actually yield equivalent results, but moving from the definition to the PV formula requires substituting <span class="math">\(\beta\)</span> for <span class="math">\(\beta^{-1}\)</span> after applying the transform. This is best understood by example.</p>
<div class="section" id="first-pv-example">
<h3><a class="toc-backref" href="#id23">First PV Example</a><a class="headerlink" href="#first-pv-example" title="Permalink to this headline">¶</a></h3>
<p>Let the sequence of payoffs be <span class="math">\(x_n = A \psi^n\)</span>, where <span class="math">\((A, \psi) \in \mathbb{R}\)</span>. We can use the z-transform to compute the present value of this sequence directly. We can look up the z-transform we are interested in from the table of transforms. Note that in doing this we take the z-transform in terms of the variable <span class="math">\(\beta\)</span> to conform to our definition of the present value <a href="#equation-eq_PVdef">(2)</a>.</p>
<div class="math">
\[X(\beta) = \mathcal{Z}(\psi^n) = \frac{1}{1 - \psi \beta^{-1}}\]</div>
<p>The z-transforms contained in the table use the <span class="math">\(z^{-n}\)</span> representation, whereas we would like <span class="math">\(\beta^n\)</span>. To overcome this we simply substitute <span class="math">\(\beta\)</span> with <span class="math">\(\beta^{-1}\)</span> in our z-transform to obtain</p>
<div class="math">
\[X(\beta) =  \frac{1}{1 - \psi \beta}\]</div>
<p>We can now use the linearity property of the z-transform to include the <span class="math">\(A\)</span> from the definition of the sequence. The property states that</p>
<div class="math">
\[a_1 x_1[n] + z_2 x_2[n] =  a_1 X_1(z) + a_2 X_2(z)\]</div>
<p>In our situation we don&#8217;t have a linear combination of sequences, but we do have a scalar multiple of the sequence. We see that the scalar just passes directly through the transform. Applying this to our sequence we obtain the final expression for the present value.</p>
<div class="math">
\[PV(\beta) = \frac{A}{1 - \psi \beta}\]</div>
</div>
<div class="section" id="second-pv-example">
<h3><a class="toc-backref" href="#id24">Second PV Example</a><a class="headerlink" href="#second-pv-example" title="Permalink to this headline">¶</a></h3>
<p>Let the sequence of payoffs be <span class="math">\(x_n = n \lambda^n\)</span>. We want to use the z-transform to compute its present value</p>
<p>We can see from the table of properties that <span class="math">\(\mathcal{Z}(n x_n) = -z \frac{\partial X(z)}{\partial z}\)</span>. We can apply this property, as well as the z-transform of <span class="math">\(\lambda^n\)</span> to evaluate the present value (note that we compute this in terms of <span class="math">\(\beta\)</span> instead of <span class="math">\(z\)</span>).</p>
<div class="math">
\[X(\beta) = \mathcal{Z}(\lambda^n) = \frac{1}{1 - \lambda \beta^{-1}}\]</div>
<p>As in the previous example, because we used <span class="math">\(\beta^{-n}\)</span> when we looked up the z-transform from the table, we need to replace <span class="math">\(\beta \rightarrow \beta^{-1}\)</span>. Doing so yields the following expression:</p>
<div class="math">
\[X(\beta) = \frac{1}{1 - \lambda \beta}\]</div>
<p>We now apply the property from above and finish the calculation of the present value. Note that because we have made the substitution <span class="math">\(\beta \rightarrow \beta^{-1}\)</span>, the negative sign on the property disappears (why? Can you verify this?) and the expression becomes <span class="math">\(\mathcal{Z}(n x_n) = z \frac{\partial X(z)}{\partial z}\)</span>.</p>
<div class="math">
\[\begin{split}PV(\beta) &amp;= \beta \left[ \frac{\partial X(\beta)}{\partial \beta} \right]\\
&amp;= \beta \left[ \frac{\partial}{\partial \beta } \left(\frac{1}{1 - \lambda \beta} \right) \right] \\
&amp;= \beta \left[ \frac{\lambda }{(1-\beta  \lambda )^2} \right] \\
&amp;= \frac{\lambda \beta }{(1-\beta  \lambda )^2}\end{split}\]</div>
</div>
<div class="section" id="reminders-for-pv-calculations">
<h3><a class="toc-backref" href="#id25">Reminders for PV Calculations</a><a class="headerlink" href="#reminders-for-pv-calculations" title="Permalink to this headline">¶</a></h3>
<p>When using the z-transform to compute do present value calculations it is important to keep a few things in mind:</p>
<ul class="simple">
<li>Make sure that you adjust <span class="math">\(X(z)\)</span> to be in terms of <span class="math">\(z^n\)</span> immediately after taking the transform. As shown in the two examples above, this is done by substituting <span class="math">\(z \rightarrow z^{-1}\)</span>. Note that if you compute the infinite sum directly, just use <span class="math">\(z^n\)</span> to begin with and don&#8217;t worry about making substitutions.</li>
<li>Carefully examine the transform, properties, and theorems tables to avoid computing the infinite sum in the transform definition directly. Often this will require a little bit of algebra on the initial sequence to get it in the form of an one or more entries in the table.</li>
</ul>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Introduction to Z-Transforms</a><ul>
<li><a class="reference internal" href="#the-z-transform">The Z-Transform</a><ul>
<li><a class="reference internal" href="#first-example">First Example</a></li>
<li><a class="reference internal" href="#second-example">Second Example</a></li>
<li><a class="reference internal" href="#on-your-own">On Your Own</a></li>
</ul>
</li>
<li><a class="reference internal" href="#transform-table">Transform Table</a></li>
<li><a class="reference internal" href="#the-inverse-z-transform">The Inverse Z-Transform</a><ul>
<li><a class="reference internal" href="#example">Example</a></li>
</ul>
</li>
<li><a class="reference internal" href="#properties-of-the-z-transform">Properties of the Z-Transform</a></li>
<li><a class="reference internal" href="#theorems-associated-with-the-z-transform">Theorems Associated with the Z-Transform</a></li>
<li><a class="reference internal" href="#solving-a-linear-difference-equation">Solving a Linear Difference Equation</a></li>
<li><a class="reference internal" href="#present-value-calculations">Present Value Calculations</a><ul>
<li><a class="reference internal" href="#first-pv-example">First PV Example</a></li>
<li><a class="reference internal" href="#second-pv-example">Second PV Example</a></li>
<li><a class="reference internal" href="#reminders-for-pv-calculations">Reminders for PV Calculations</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="../linear_pred/lin_pred.html"
                        title="previous chapter">Simple linear prediction theory</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="definition.html"
                        title="next chapter">The Z-Transform</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/ztransforms/z_transforms.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="definition.html" title="The Z-Transform"
             >next</a> |</li>
        <li class="right" >
          <a href="../linear_pred/lin_pred.html" title="Simple linear prediction theory"
             >previous</a> |</li>
        <li><a href="../index.html">pyTM 1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2013, Coleman, Lyon, &amp; Sargent.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>